Steps

- Depending on whether student found file location or wants to find location
- Write file address call 
	- to write file 			0x76FA1282
	- Called by 				0x004056C7 
	- Create file 				0x00405661

For writing the file
	- Beginning of Function 	0x004055E0
	IP / Domain service call 	0x0040258B

InternetReadFile
	- Send file 				0x00401DE8
	- Internet read file 
		Passed parameters;					0x7711FA74
			Arg1: hFile						83A670
			Arg2: lpBuffer					0
			Arg3: dwNumberOfBytesToRead		0
			Arg4: lpdwNumberOfBytesRead		0
	- Parameter corresponding to buffer being returned

	- Internet Close handle					0x761E5B7F
		- Where is the response (Check the pointer the buffer passed by the caller)
			Check addresses					0x77145672

	Check into force jumps
		- Returns to caller 			0x0040258E
			- Which in turn calls			0x770FDF5C



OllyDBG
- Ctrl-G to follow expression specified in search
- We know that the malware is writing so we can set a break point on whatever windows .dll the malware is calling
- Search "writefile" for options within the windows .dll
- Fn-F2 to create breakpoint
- Fn-F9 to run till the break point is ran
- To view malware, go to view -> call stack or Alt-K
- When we double click the break pointed code we can see the relavent code
- We want to set a break point on the relevant spot at the line specified. (Were the malware writes to the file)
- Atl-B to disable the previously set break point
- Find the location of the data being written using the information from the buffer of the new break point. The information should be shown in the call stack 

A Few lines before the writefile call, we can see the create a file kernel32.CreateFileA API call (Can be seen in the process mon)
- Then analyze the creation of the file



Found information

C2 Server
- 81.4.111.176

Sources
- http://www.pbwcz.cz/30.html
- https://translate.google.com/translate?sl=auto&tl=en&js=y&prev=_t&hl=en&ie=UTF-8&u=http%3A%2F%2Fwww.pbwcz.cz%2F30.html&edit-text=&act=url
- https://malwr.com/analysis/ZmI2NDliMWEzYjc5NGViOWJjZDU3MDE0NjM1NDM3ODg/